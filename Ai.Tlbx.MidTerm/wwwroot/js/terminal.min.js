"use strict";(()=>{var qn=Object.defineProperty;var S=(e,t)=>()=>(e&&(t=e(e=0)),t);var _t=(e,t)=>{for(var n in t)qn(e,n,{get:t[n],enumerable:!0})};var E,G,de,J,Pt,Ht,V,ue,me,pe,fe,De,Dt,L=S(()=>{"use strict";E={dark:{background:"#101014",foreground:"#DCDCF5",cursor:"#DCDCF5",cursorAccent:"#101014",selectionBackground:"#283457"},light:{background:"#D5D6DB",foreground:"#343B58",cursor:"#343B58",cursorAccent:"#D5D6DB",selectionBackground:"#9FA0A5"},solarizedDark:{background:"#002B36",foreground:"#839496",cursor:"#839496",cursorAccent:"#002B36",selectionBackground:"#073642"},solarizedLight:{background:"#FDF6E3",foreground:"#657B83",cursor:"#657B83",cursorAccent:"#FDF6E3",selectionBackground:"#EEE8D5"}},G=1e3,de=3e4,J="'Cascadia Code', 'Cascadia Mono', Consolas, 'Courier New', monospace",Pt=.6,Ht=1.2,V=8,ue=10,me=5,pe=300,fe=100,De=500,Dt=768});function Ft(e){d=e}function ee(e){c=e}function Ue(e){m=e}function Se(e){A=e}function Ot(e){I=e}function ze(e){_=e}function Ve(e){ge=e}function ye(e){Kn=e}function qe(e){Z=e}function Wt(e){Fe=e}function Ke(e){Oe=e}function Xe(e){q=e}function $e(e){T=e}function Ut(e){We=e}function je(e){he=e}function Ye(e){P=e}function be(e){Q=e}function zt(e){ve=e}function Vt(){a.sessionList=document.getElementById("session-list"),a.sessionCount=document.getElementById("session-count"),a.terminalsArea=document.querySelector(".terminals-area"),a.emptyState=document.getElementById("empty-state"),a.mobileTitle=document.getElementById("mobile-title"),a.topbarActions=document.getElementById("topbar-actions"),a.app=document.getElementById("app"),a.sidebarOverlay=document.getElementById("sidebar-overlay"),a.settingsView=document.getElementById("settings-view"),a.settingsBtn=document.getElementById("btn-settings"),a.islandTitle=document.getElementById("island-title")}var d,c,m,A,I,_,ge,Kn,Z,Fe,Oe,q,T,We,he,P,ve,u,K,H,M,Q,a,v=S(()=>{"use strict";d=[],c=null,m=null,A=null,I=null,_=!1,ge=!1,Kn=!1,Z=null,Oe=1e3,q=!1,T=null,he=1e3,P=!1,ve=null,u=new Map,K=new Set,H=new Set,M=new Map,Q=null,a={sessionList:null,sessionCount:null,terminalsArea:null,emptyState:null,mobileTitle:null,topbarActions:null,app:null,sidebarOverlay:null,settingsView:null,settingsBtn:null,islandTitle:null}});function N(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}function f(e,t){let n=document.getElementById(e);n&&n.addEventListener("click",t)}var qt=S(()=>{"use strict"});function Ge(e){let t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?decodeURIComponent(t[2]):null}function D(e,t,n=365){let o=new Date(Date.now()+n*24*60*60*1e3).toUTCString();document.cookie=`${e}=${encodeURIComponent(t)}; expires=${o}; path=/`}function Kt(e){if(e!=="auto")return e;let t=navigator.userAgent||"";return/Windows|Win32|Win64/i.test(t)?"windows":"unix"}var Xt=S(()=>{"use strict"});function xe(e){let t=e[0]|e[1]<<8,n=e[2]|e[3]<<8,o=e.slice(4),s=t>0&&t<=De&&n>0&&n<=De;return{cols:t,rows:n,data:o,valid:s}}var $t=S(()=>{"use strict";L()});function Ee(e,t,n,o,s,i){i!==void 0&&clearTimeout(i);let r=window.setTimeout(()=>{o(Math.min(e*1.5,t)),n()},e);s(r)}var jt=S(()=>{"use strict"});var w=S(()=>{"use strict";qt();Xt();$t();jt()});function Qe(e){e.sendResize&&(Ze=e.sendResize)}function F(e){let t=u.get(e);if(!t)return;if(!t.opened){(Q??Promise.resolve()).then(()=>{F(e)});return}let n=t.container.querySelector(".xterm");n&&(n.style.zoom="",n.style.transform="",t.container.classList.remove("scaled"));let o=t.container.classList.contains("hidden");o&&t.container.classList.remove("hidden");let s=a.terminalsArea?.getBoundingClientRect();if(!s||s.width<100||s.height<100){o&&t.container.classList.add("hidden");return}let i=t.terminal._core?._renderService,r=i?.dimensions?.css?.cell?.width,l=i?.dimensions?.css?.cell?.height;if(!r||!l){requestAnimationFrame(()=>{try{let Bt=t.fitAddon.proposeDimensions();Bt?.cols&&Bt?.rows&&(t.fitAddon.fit(),Ze(e,t.terminal))}catch{}o&&t.container.classList.add("hidden")});return}let p=s.width-V,g=s.height-V,h=Math.floor(p/r),x=Math.floor(g/l);h=Math.max(ue,Math.min(h,pe)),x=Math.max(me,Math.min(x,fe)),requestAnimationFrame(()=>{try{(t.terminal.cols!==h||t.terminal.rows!==x)&&(t.terminal.resize(h,x),Ze(e,t.terminal))}catch{}o&&t.container.classList.add("hidden")})}function O(e,t){let n=t.container,o=n.querySelector(".xterm");o&&requestAnimationFrame(()=>{let s=n.clientWidth-8,i=n.clientHeight-8,r=o.offsetWidth,l=o.offsetHeight,p=s/r,g=i/l,h=Math.min(p,g,1);h<.99?(o.style.zoom=h,o.style.transform="",n.classList.add("scaled")):(o.style.zoom="",o.style.transform="",n.classList.remove("scaled"))})}function X(){u.forEach((e,t)=>{e.opened&&O(t,e)})}function et(){window.addEventListener("resize",X)}function tt(){if(!window.visualViewport||!a.terminalsArea)return;let e=0,t=()=>{let n=window.visualViewport.height;if(Math.abs(n-e)<1)return;e=n,document.documentElement.style.setProperty("--visual-vh",n+"px");let o=document.querySelector(".mobile-header"),s=0;o&&window.getComputedStyle(o).display!=="none"&&(s=o.offsetHeight);let i=Math.floor((n-s)*.99);a.terminalsArea.style.height=i+"px"};window.visualViewport.addEventListener("resize",t),t()}var Ze,Le=S(()=>{"use strict";L();v();Ze=()=>{}});function nt(e){e.sendInput&&(no=e.sendInput),e.pasteToTerminal&&(Ae=e.pasteToTerminal)}async function cn(e,t){let n=new FormData;n.append("file",t);try{let o=await fetch(`/api/sessions/${e}/upload`,{method:"POST",body:n});return o.ok?(await o.json()).path:(console.error("File upload failed:",o.status),null)}catch(o){return console.error("File upload error:",o),null}}async function oo(e){if(!c||e.length===0)return;let t=[];for(let n of Array.from(e)){let o=await cn(c,n);o&&t.push(o)}t.length>0&&Ae(c,t.join(" "))}function ot(e){e.addEventListener("dragover",t=>{t.preventDefault(),t.stopPropagation(),e.classList.add("drag-over")}),e.addEventListener("dragleave",t=>{t.preventDefault(),t.stopPropagation(),e.classList.remove("drag-over")}),e.addEventListener("dragend",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",async t=>{t.preventDefault(),t.stopPropagation(),e.classList.remove("drag-over");let n=t.dataTransfer?.files;n&&n.length>0&&await oo(n)})}async function ne(e){try{let t=await navigator.clipboard.read();for(let n of t){let o=n.types.find(s=>s.startsWith("image/"));if(o){let s=await n.getType(o),i=new Date().toISOString().replace(/[:.]/g,"-"),r=new File([s],`clipboard_${i}.jpg`,{type:o}),l=await cn(e,r);if(l){Ae(e,l);return}}}}catch{}try{let t=await navigator.clipboard.readText();t&&Ae(e,t)}catch{}}var no,Ae,st=S(()=>{"use strict";v();no=()=>{},Ae=()=>{}});function at(e,t){try{let n=new SearchAddon.SearchAddon;t.loadAddon(n),se.set(e,{addon:n,currentIndex:0,totalMatches:0})}catch{}}function lt(e){se.delete(e)}function ct(){$||($=document.getElementById("terminal-search"),B=document.getElementById("search-input"),R=document.getElementById("search-results")),$&&B&&($.classList.remove("hidden"),rt=!0,B.focus(),B.select())}function oe(){if($&&($.classList.add("hidden"),rt=!1),c){let e=se.get(c);e?.addon&&e.addon.clearDecorations()}if(c){let e=u.get(c);e&&e.terminal.focus()}}function dt(){return rt}function Ie(){if(!c||!B)return;let e=B.value;if(!e)return;let t=se.get(c);if(!t?.addon)return;let n=t.addon.findNext(e,{incremental:!1});dn(n)}function it(){if(!c||!B)return;let e=B.value;if(!e)return;let t=se.get(c);if(!t?.addon)return;let n=t.addon.findPrevious(e);dn(n)}function dn(e){R&&(e?(R.textContent="Found",R.style.color=""):(R.textContent="No matches",R.style.color="var(--accent-red)"))}function ut(){let e=document.getElementById("search-input"),t=document.getElementById("search-prev"),n=document.getElementById("search-next"),o=document.getElementById("search-close");e&&(e.addEventListener("input",()=>{c&&e.value?Ie():R&&(R.textContent="0/0",R.style.color="")}),e.addEventListener("keydown",s=>{s.key==="Enter"?(s.preventDefault(),s.shiftKey?it():Ie()):s.key==="Escape"&&(s.preventDefault(),oe())})),t&&t.addEventListener("click",it),n&&n.addEventListener("click",Ie),o&&o.addEventListener("click",oe)}var se,rt,B,R,$,mt=S(()=>{"use strict";v();se=new Map,rt=!1,B=null,R=null,$=null});function so(e,t){if(d.find(i=>i.id===e)?.manuallyNamed)return;let o=ie.get(e);o&&window.clearTimeout(o);let s=window.setTimeout(()=>{ie.delete(e),fetch(`/api/sessions/${e}/name?auto=true`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})}).catch(()=>{})},500);ie.set(e,s)}function ft(e){e.sendInput&&(pt=e.sendInput),e.showBellNotification&&(un=e.showBellNotification)}function gt(){let e=window.innerWidth<=Dt,t=m?.fontSize??14,n=e?Math.max(t-2,10):t,o=m?.theme??"dark",s=m?.fontFamily??"Cascadia Code",i={cursorBlink:m?.cursorBlink??!0,cursorStyle:m?.cursorStyle??"bar",fontFamily:`'${s}', ${J}`,fontSize:n,letterSpacing:0,lineHeight:1,scrollback:m?.scrollbackLines??1e4,minimumContrastRatio:m?.minimumContrastRatio??1,smoothScrollDuration:m?.smoothScrolling?150:0,allowProposedApi:!0,customGlyphs:!0,rescaleOverlappingGlyphs:!0,theme:E[o]??E.dark};return ve!==null&&(i.windowsPty={backend:"conpty",buildNumber:ve}),i}function ht(e,t){let n=u.get(e);if(n)return n;let o=document.createElement("div");o.className="terminal-container hidden",o.id="terminal-"+e,a.terminalsArea?.appendChild(o),ot(o);let s=new Terminal(gt()),i=new FitAddon.FitAddon;s.loadAddon(i);let r=t&&t.cols>0?t.cols:0,l=t&&t.rows>0?t.rows:0,p={terminal:s,fitAddon:i,container:o,serverCols:r,serverRows:l,opened:!1};return u.set(e,p),(Q??Promise.resolve()).then(()=>{if(u.has(e)){if(s.open(o),p.opened=!0,m?.useWebGL!==!1)try{let g=new WebglAddon.WebglAddon;g.onContextLost(()=>{g.dispose()}),s.loadAddon(g)}catch{}try{let g=new WebLinksAddon.WebLinksAddon((h,x)=>{(x.startsWith("http://")||x.startsWith("https://"))&&window.open(x,"_blank","noopener,noreferrer")});s.loadAddon(g)}catch{}at(e,s),io(e,p),requestAnimationFrame(()=>{u.has(e)&&(F(e),pn(e,s,o))})}}),p}function io(e,t){let n=M.get(e);n&&n.length>0&&(n.forEach(o=>{mn(e,t,o)}),M.delete(e))}function mn(e,t,n){let o=xe(n);if(o.valid&&t.terminal._core&&t.terminal._core._renderService){let s=t.terminal.cols,i=t.terminal.rows;if(s!==o.cols||i!==o.rows)try{t.terminal.resize(o.cols,o.rows),t.serverCols=o.cols,t.serverRows=o.rows,O(e,t)}catch{}}o.data.length>0&&t.terminal.write(o.data)}function pn(e,t,n){t.onData(r=>{pt(e,r)}),t.onBell(()=>{un(e)}),t.onSelectionChange(()=>{m?.copyOnSelect&&t.hasSelection()&&navigator.clipboard.writeText(t.getSelection()).catch(()=>{})}),t.onTitleChange(r=>{r&&r.trim()&&so(e,r.trim())}),t.attachCustomKeyEventHandler(r=>{if(r.type!=="keydown")return!0;if(r.ctrlKey&&!r.shiftKey&&!r.altKey&&!r.metaKey&&r.key==="Enter")return pt(e,`
`),!1;if(Kt(m?.clipboardShortcuts??"auto")==="windows"){if(r.ctrlKey&&!r.shiftKey&&r.key==="c")return t.hasSelection()?(navigator.clipboard.writeText(t.getSelection()).catch(()=>{}),t.clearSelection(),!1):!0;if(r.ctrlKey&&!r.shiftKey&&r.key==="v")return ne(e),!1}else{if(r.ctrlKey&&r.shiftKey&&(r.key==="C"||r.key==="c"))return t.hasSelection()&&(navigator.clipboard.writeText(t.getSelection()).catch(()=>{}),t.clearSelection()),!1;if(r.ctrlKey&&r.shiftKey&&(r.key==="V"||r.key==="v"))return ne(e),!1}return(r.ctrlKey||r.metaKey)&&r.key==="f"?(ct(),!1):r.key==="Escape"&&dt()?(oe(),!1):!0});let o=r=>{r.preventDefault(),r.stopPropagation(),r.stopImmediatePropagation()};n.addEventListener("paste",o,!0);let s=r=>{(!m||m.rightClickPaste!==!1)&&(r.preventDefault(),ne(e))};n.addEventListener("contextmenu",s);let i=u.get(e);i&&(i.contextMenuHandler=s,i.pasteHandler=o)}function Me(e){let t=u.get(e);if(!t)return;t.contextMenuHandler&&t.container.removeEventListener("contextmenu",t.contextMenuHandler),t.pasteHandler&&t.container.removeEventListener("paste",t.pasteHandler,!0),lt(e);let n=ie.get(e);n&&(clearTimeout(n),ie.delete(e)),t.terminal.dispose(),t.container.remove(),u.delete(e),M.delete(e)}function vt(e,t){let n=u.get(e);n&&n.terminal.paste(t)}function ro(){let e=gt();u.forEach(t=>{t.terminal.options.cursorBlink=e.cursorBlink,t.terminal.options.cursorStyle=e.cursorStyle,t.terminal.options.fontSize=e.fontSize,t.terminal.options.theme=e.theme})}function fn(e,t){fetch("/api/sessions/"+e+"/buffer").then(n=>n.ok?n.text():"").then(n=>{n&&t.write(n)}).catch(n=>{console.error("Error fetching buffer:",n)})}function ke(){if(!c)return;let e=u.get(c);e&&e.opened&&(e.terminal.clear(),fn(c,e.terminal))}function St(){let e=document.fonts.ready.then(()=>{let t=document.createElement("span");return t.style.fontFamily=J,t.style.position="absolute",t.style.left="-9999px",t.textContent="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",document.body.appendChild(t),new Promise(n=>{requestAnimationFrame(()=>{t.remove(),n()})})});return be(e),e}var pt,un,ie,gn=S(()=>{"use strict";L();v();w();Le();st();mt();pt=()=>{},un=()=>{},ie=new Map});var hn={};_t(hn,{applySettingsToTerminals:()=>ro,applyTerminalScaling:()=>O,bindSearchEvents:()=>ut,cleanupSearchForTerminal:()=>lt,createTerminalForSession:()=>ht,destroyTerminalForSession:()=>Me,fetchAndWriteBuffer:()=>fn,findNext:()=>Ie,findPrevious:()=>it,fitSessionToScreen:()=>F,getTerminalOptions:()=>gt,handleClipboardPaste:()=>ne,hideSearch:()=>oe,initSearchForTerminal:()=>at,isSearchVisible:()=>dt,pasteToTerminal:()=>vt,preloadTerminalFont:()=>St,refreshActiveTerminalBuffer:()=>ke,registerFileDropCallbacks:()=>nt,registerScalingCallbacks:()=>Qe,registerTerminalCallbacks:()=>ft,rescaleAllTerminals:()=>X,setupFileDrop:()=>ot,setupResizeObserver:()=>et,setupTerminalEvents:()=>pn,setupVisualViewport:()=>tt,showSearch:()=>ct,writeOutputFrame:()=>mn});var yt=S(()=>{"use strict";gn();Le();mt();st()});function y(e,t){let n=document.getElementById(e);n&&(n.value=String(t))}function U(e,t){let n=document.getElementById(e);n&&(n.checked=t)}function b(e,t){let n=document.getElementById(e);return n?n.value:t}function z(e){let t=document.getElementById(e);return t?t.checked:!1}function Ln(e){let t=document.getElementById("version-web");if(t&&e){let n=e.split(/[+-]/)[0].split(".").slice(0,3).join(".");t.textContent="v"+n}}function An(e,t){let n=document.getElementById("setting-run-as-user");n&&(n.innerHTML='<option value="">Process Owner (default)</option>',e.forEach(o=>{let s=document.createElement("option");s.value=o.username,s.textContent=o.username,o.username===t&&(s.selected=!0),n.appendChild(s)}))}function In(e){y("setting-default-shell",e.defaultShell||"Pwsh"),y("setting-working-dir",e.defaultWorkingDirectory||""),y("setting-font-size",e.fontSize||14),y("setting-font-family",e.fontFamily||"Cascadia Code"),y("setting-cursor-style",e.cursorStyle||"bar"),U("setting-cursor-blink",e.cursorBlink!==!1),y("setting-theme",e.theme||"dark"),y("setting-contrast",String(e.minimumContrastRatio||1)),y("setting-scrollback",e.scrollbackLines||1e4),y("setting-bell-style",e.bellStyle||"notification"),U("setting-copy-on-select",e.copyOnSelect===!0),U("setting-right-click-paste",e.rightClickPaste!==!1),y("setting-clipboard-shortcuts",e.clipboardShortcuts||"auto"),U("setting-smooth-scrolling",e.smoothScrolling===!0),U("setting-webgl",e.useWebGL!==!1),y("setting-run-as-user",e.runAsUser||""),U("setting-debug-logging",e.debugLogging===!0)}async function re(){try{let[e,t,n]=await Promise.all([fetch("/api/settings").then(o=>o.json()),fetch("/api/users").then(o=>o.json()).catch(()=>[]),fetch("/api/version").then(o=>o.text()).catch(()=>null)]);Ue(e),An(t,e.runAsUser),In(e),Ln(n),Mn()}catch(e){console.error("Error fetching settings:",e)}}function Mn(){if(!m)return;let e=E[m.theme]||E.dark,t=`'${m.fontFamily||"Cascadia Code"}', ${J}`;u.forEach(n=>{if(n.terminal.options.cursorBlink=m.cursorBlink,n.terminal.options.cursorStyle=m.cursorStyle,n.terminal.options.fontFamily=t,n.terminal.options.fontSize=m.fontSize,n.terminal.options.theme=e,n.terminal.options.minimumContrastRatio=m.minimumContrastRatio,n.terminal.options.smoothScrollDuration=m.smoothScrolling?150:0,n.opened)try{let o=n.fitAddon.proposeDimensions();o?.cols&&o?.rows&&n.fitAddon.fit()}catch{}})}function _e(){let e=b("setting-run-as-user",""),t={defaultShell:b("setting-default-shell","Pwsh"),defaultWorkingDirectory:b("setting-working-dir",""),fontSize:parseInt(b("setting-font-size","14"),10)||14,fontFamily:b("setting-font-family","Cascadia Code"),cursorStyle:b("setting-cursor-style","bar"),cursorBlink:z("setting-cursor-blink"),theme:b("setting-theme","dark"),minimumContrastRatio:parseFloat(b("setting-contrast","1"))||1,smoothScrolling:z("setting-smooth-scrolling"),useWebGL:z("setting-webgl"),scrollbackLines:parseInt(b("setting-scrollback","10000"),10)||1e4,bellStyle:b("setting-bell-style","notification"),copyOnSelect:z("setting-copy-on-select"),rightClickPaste:z("setting-right-click-paste"),clipboardShortcuts:b("setting-clipboard-shortcuts","auto"),runAsUser:e||null,debugLogging:z("setting-debug-logging")};D("mm-theme",t.theme),fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(n=>{if(n.ok){Ue(t);let o=E[t.theme]||E.dark;document.documentElement.style.setProperty("--terminal-bg",o.background),Mn()}}).catch(n=>{console.error("Error saving settings:",n)})}function co(){let e=a.settingsView;e&&(e.querySelectorAll('select, input[type="checkbox"]').forEach(t=>{t.addEventListener("change",_e)}),e.querySelectorAll(".text-input-wrapper").forEach(t=>{let n=t.querySelector("input"),o=t.querySelector(".inline-save-btn");if(!n||!o)return;let s="";n.addEventListener("focus",()=>{s=n.value}),n.addEventListener("input",()=>{t.classList.toggle("unsaved",n.value!==s)}),o.addEventListener("click",()=>{_e(),t.classList.remove("unsaved"),s=n.value}),n.addEventListener("keydown",i=>{i.key==="Enter"&&(i.preventDefault(),_e(),t.classList.remove("unsaved"),s=n.value)})}))}var xt=S(()=>{"use strict";L();v();w()});function uo(){let e=a.app;e&&e.classList.remove("sidebar-open")}function Et(){_?Pe():kn()}function kn(){if(ze(!0),a.settingsBtn&&a.settingsBtn.classList.add("active"),uo(),c){let e=u.get(c);e&&e.container.classList.add("hidden")}a.emptyState&&a.emptyState.classList.add("hidden"),a.settingsView&&a.settingsView.classList.remove("hidden"),re(),Nn()}function Pe(){if(ze(!1),a.settingsBtn&&a.settingsBtn.classList.remove("active"),a.settingsView&&a.settingsView.classList.add("hidden"),c){let e=u.get(c);e&&(e.container.classList.remove("hidden"),requestAnimationFrame(()=>{e.terminal.focus()}))}else d.length===0&&a.emptyState&&a.emptyState.classList.remove("hidden")}function Rn(e){if(e<60)return e+"s";if(e<3600)return Math.floor(e/60)+"m "+e%60+"s";let t=Math.floor(e/3600),n=Math.floor(e%3600/60);return t<24?t+"h "+n+"m":Math.floor(t/24)+"d "+t%24+"h"}function Tt(e){let t=document.getElementById("conhost-warning");if(!t){t=document.createElement("div"),t.id="conhost-warning",t.className="warning-banner";let n=document.querySelector(".app-header");n&&n.parentNode&&n.parentNode.insertBefore(t,n.nextSibling)}e.conHostVersion&&e.conHostCompatible===!1?(t.innerHTML="<strong>Version mismatch:</strong> mmttyhost is "+e.conHostVersion+", expected "+e.conHostExpected+". Terminals may not work correctly. Please update mmttyhost.exe or restart the service.",t.style.display="block"):t.style.display="none"}function Nn(){let e=document.getElementById("system-status-content");e&&fetch("/api/health").then(t=>t.json()).then(t=>{let n=t.healthy?"status-healthy":"status-error",o=t.healthy?"Healthy":"Unhealthy",s=Rn(t.uptimeSeconds||0),i="";t.conHostVersion!==null&&t.conHostVersion!==void 0&&(i='<div class="status-detail-row"><span class="detail-label">mmttyhost</span><span class="detail-value '+(t.conHostCompatible?"":"status-error")+'">'+t.conHostVersion+(t.conHostCompatible?"":" expected "+t.conHostExpected)+"</span></div>"),e.innerHTML='<div class="status-grid"><div class="status-item"><span class="status-label">Status</span><span class="status-value '+n+'">'+o+'</span></div><div class="status-item"><span class="status-label">Mode</span><span class="status-value">'+(t.mode||"")+'</span></div><div class="status-item"><span class="status-label">Sessions</span><span class="status-value">'+t.sessionCount+'</span></div><div class="status-item"><span class="status-label">Uptime</span><span class="status-value">'+s+'</span></div></div><div class="status-details"><div class="status-detail-row"><span class="detail-label">Platform</span><span class="detail-value">'+(t.platform||"")+'</span></div><div class="status-detail-row"><span class="detail-label">Process ID</span><span class="detail-value">'+(t.webProcessId||"")+"</span></div>"+i+"</div>",Tt(t)}).catch(t=>{let n=t instanceof Error?t.message:String(t);e.innerHTML='<div class="status-error-msg">Failed to load system status: '+n+"</div>"})}function wt(){fetch("/api/health").then(e=>e.json()).then(e=>{Tt(e),e.windowsBuildNumber!==void 0&&zt(e.windowsBuildNumber)}).catch(()=>{})}var Bn=S(()=>{"use strict";v();xt()});var _n={};_t(_n,{bindSettingsAutoSave:()=>co,checkSystemHealth:()=>wt,closeSettings:()=>Pe,fetchSettings:()=>re,fetchSystemStatus:()=>Nn,formatUptime:()=>Rn,getElementChecked:()=>z,getElementValue:()=>b,openSettings:()=>kn,populateSettingsForm:()=>In,populateUserDropdown:()=>An,populateVersionInfo:()=>Ln,saveAllSettings:()=>_e,setElementChecked:()=>U,setElementValue:()=>y,toggleSettings:()=>Et,updateConHostWarning:()=>Tt});var Ct=S(()=>{"use strict";Bn();xt()});L();v();w();function Yt(){let e=document.cookie.match(/mm-theme=([^;]+)/)?.[1];e&&E[e]&&document.documentElement.style.setProperty("--terminal-bg",E[e].background)}L();w();v();var Gt=()=>{},Jt=()=>{},Zt=()=>{},Qt=()=>{},Je=()=>{},en=()=>{},tn=()=>{};function nn(e){e.destroyTerminalForSession&&(Gt=e.destroyTerminalForSession),e.applyTerminalScaling&&(Jt=e.applyTerminalScaling),e.renderSessionList&&(Zt=e.renderSessionList),e.updateEmptyState&&(Qt=e.updateEmptyState),e.selectSession&&(Je=e.selectSession),e.updateMobileTitle&&(en=e.updateMobileTitle),e.renderUpdatePanel&&(tn=e.renderUpdatePanel)}function Te(){Z&&(Z.onclose=null,Z.close(),qe(null));let e=location.protocol==="https:"?"wss:":"ws:",t=new WebSocket(`${e}//${location.host}/ws/state`);qe(t),t.onopen=()=>{Ke(G),Xe(!0),te()},t.onmessage=n=>{try{let o=JSON.parse(n.data),s=o.sessions?.sessions??[];Xn(s),$n(o.update)}catch(o){let s=o instanceof Error?o.message:String(o);console.error("Error parsing state:",s)}},t.onclose=()=>{Xe(!1),te(),jn()},t.onerror=n=>{console.error("State WebSocket error:",n)}}function Xn(e){let t=new Set(e.map(n=>n.id));u.forEach((n,o)=>{t.has(o)||(Gt(o),K.delete(o))}),e.forEach(n=>{let o=u.get(n.id);o&&o.opened?(o.serverCols!==n.cols||o.serverRows!==n.rows)&&(o.serverCols=n.cols,o.serverRows=n.rows,o.terminal.resize(n.cols,n.rows),Jt(n.id,o)):o&&(o.serverCols=n.cols,o.serverRows=n.rows)}),Ft(e),Zt(),Qt(),!c&&d.length>0&&Je(d[0].id),c&&!d.find(n=>n.id===c)&&(ee(null),d.length>0&&Je(d[0].id)),en()}function $n(e){Se(e),tn()}function jn(){Ee(Oe,de,Te,Ke,Wt,Fe)}function te(){let e=document.getElementById("connection-status");if(!e)return;let t,n;q&&P?(t="connected",n=""):!q&&!P?(t="disconnected",n="Server disconnected"):(t="reconnecting",n="Reconnecting..."),e.className=`connection-status ${t}`,e.textContent=n}L();w();v();var on=()=>{},sn=()=>{};function rn(e){e.applyTerminalScaling&&(on=e.applyTerminalScaling),e.refreshActiveTerminalBuffer&&(sn=e.refreshActiveTerminalBuffer)}function we(){T&&(T.onclose=null,T.close(),$e(null));let e=location.protocol==="https:"?"wss:":"ws:",t=new WebSocket(`${e}//${location.host}/ws/mux`);t.binaryType="arraybuffer",$e(t),t.onopen=()=>{let n=he>G;je(G),Ye(!0),te(),n&&sn()},t.onmessage=n=>{if(!(n.data instanceof ArrayBuffer))return;let o=new Uint8Array(n.data);if(o.length<9)return;let s=o[0],i=Qn(o,1),r=o.slice(9);if(s===5){console.log("[Resync] Clearing terminals for buffer refresh"),u.forEach(l=>{l.opened&&l.terminal.clear()}),M.clear();return}if(s===1){let l=u.get(i);l&&l.opened&&r.length>=4?to(i,l,r):r.length>=4&&(M.has(i)||M.set(i,[]),M.get(i).push(r.slice()))}},t.onclose=()=>{Ye(!1),te(),eo()},t.onerror=n=>{console.error("Mux WebSocket error:",n)}}function Ce(e,t){if(!T||T.readyState!==WebSocket.OPEN)return;let n=new TextEncoder().encode(t),o=new Uint8Array(9+n.length);o[0]=2,ln(o,1,e),o.set(n,9),T.send(o)}function an(e,t,n){if(!T||T.readyState!==WebSocket.OPEN)return;let o=new Uint8Array(13);o[0]=3,ln(o,1,e),o[9]=t&255,o[10]=t>>8&255,o[11]=n&255,o[12]=n>>8&255,T.send(o);let s=u.get(e);s&&(s.serverCols=t,s.serverRows=n)}function ln(e,t,n){for(let o=0;o<8;o++)e[t+o]=o<n.length?n.charCodeAt(o):0}function Qn(e,t){let n=[];for(let o=0;o<8;o++)e[t+o]!==0&&n.push(String.fromCharCode(e[t+o]));return n.join("")}function eo(){Ee(he,de,we,je,Ut,We)}function to(e,t,n){let o=xe(n),s=t.terminal._core;if(o.valid&&s&&s._renderService){let i=t.terminal.cols,r=t.terminal.rows;if(i!==o.cols||r!==o.rows)try{t.terminal.resize(o.cols,o.rows),t.serverCols=o.cols,t.serverRows=o.rows,on(e,t)}catch(l){let p=l instanceof Error?l.message:String(l);console.warn("Terminal resize deferred:",p)}}o.data.length>0&&t.terminal.write(o.data)}yt();v();var C=null;function vn(e){C=e}function W(e){return e.name||e.shellType}function j(){if(!a.sessionList)return;a.sessionList.innerHTML="",d.forEach(t=>{let n=H.has(t.id),o=document.createElement("div");o.className="session-item"+(t.id===c?" active":"")+(n?" pending":""),o.dataset.sessionId=t.id,n||o.addEventListener("click",()=>{C&&(C.onSelect(t.id),C.onCloseSidebar())});let s=document.createElement("div");if(s.className="session-info",n){let l=document.createElement("span");l.className="session-spinner",s.appendChild(l)}let i=document.createElement("span");i.className="session-title",i.textContent=W(t),s.appendChild(i);let r=document.createElement("div");if(r.className="session-actions",!n){let l=document.createElement("button");l.className="session-resize",l.innerHTML="\u2922",l.title="Fit to screen",l.addEventListener("click",h=>{h.stopPropagation(),C&&C.onResize(t.id)});let p=document.createElement("button");p.className="session-rename",p.innerHTML="\u270F\uFE0F",p.title="Rename session",p.addEventListener("click",h=>{h.stopPropagation(),C&&C.onRename(t.id)});let g=document.createElement("button");g.className="session-close",g.innerHTML="&times;",g.title="Close session",g.addEventListener("click",h=>{h.stopPropagation(),C&&C.onDelete(t.id)}),r.appendChild(l),r.appendChild(p),r.appendChild(g)}o.appendChild(s),o.appendChild(r),a.sessionList.appendChild(o)});let e=d.filter(t=>!H.has(t.id)).length;a.sessionCount&&(a.sessionCount.textContent=String(e))}function Re(){a.emptyState&&(d.length===0?(a.emptyState.classList.remove("hidden"),a.settingsView&&a.settingsView.classList.add("hidden")):_||a.emptyState.classList.add("hidden"))}function Ne(){if(!a.mobileTitle)return;let e=d.find(t=>t.id===c);a.mobileTitle.textContent=e?W(e):"MidTerm",a.topbarActions&&(e?a.topbarActions.classList.remove("no-terminal"):a.topbarActions.classList.add("no-terminal")),a.islandTitle&&(a.islandTitle.textContent=e?W(e):"MidTerm")}v();w();Le();var bt="mm-sidebar-collapsed",Sn="mm-sidebar-width",ao=768,yn=180,bn=400;function xn(){Ve(!ge),a.app&&a.app.classList.toggle("sidebar-open",ge)}function Be(){Ve(!1),a.app&&a.app.classList.remove("sidebar-open")}function En(){ye(!0),a.app&&a.app.classList.add("sidebar-collapsed"),D(bt,"true"),lo(),requestAnimationFrame(X)}function Tn(){ye(!1),a.app&&a.app.classList.remove("sidebar-collapsed"),D(bt,"false"),requestAnimationFrame(X)}function lo(){if(!a.islandTitle)return;let e=d.find(t=>t.id===c);a.islandTitle.textContent=e?W(e):"MidTerm"}function wn(){Ge(bt)==="true"&&window.innerWidth>ao&&(ye(!0),a.app&&a.app.classList.add("sidebar-collapsed"));let e=Ge(Sn);if(e){let t=parseInt(e,10);if(t>=yn&&t<=bn){let n=document.getElementById("sidebar");n&&(n.style.width=t+"px")}}}function Cn(){let e=document.getElementById("sidebar-resize-grip"),t=document.getElementById("sidebar");if(!e||!t)return;let n=!1,o=0,s=0;e.addEventListener("mousedown",i=>{n=!0,o=i.clientX,s=t.offsetWidth,e.classList.add("active"),document.body.style.cursor="ew-resize",document.body.style.userSelect="none",i.preventDefault()}),document.addEventListener("mousemove",i=>{if(!n)return;let r=i.clientX-o,l=Math.max(yn,Math.min(bn,s+r));t.style.width=l+"px",X()}),document.addEventListener("mouseup",()=>{if(!n)return;n=!1,e.classList.remove("active"),document.body.style.cursor="",document.body.style.userSelect="";let i=t.offsetWidth;D(Sn,String(i))})}Ct();v();async function ae(){try{let e=await fetch("/api/auth/status");if(e.status===401){window.location.href="/login.html";return}let t=await e.json();Ot(t),Pn(),Hn()}catch(e){console.error("Auth status error:",e)}}function Pn(){let e=document.getElementById("security-warning");e&&(I&&I.authenticationEnabled&&!I.passwordSet?e.classList.remove("hidden"):e.classList.add("hidden"))}function Hn(){let e=document.getElementById("password-status-text");if(e){if(!I){e.textContent="Checking...",e.className="";return}I.passwordSet?(e.textContent="Password is set",e.className="status-set"):(e.textContent="No password set",e.className="status-missing")}}function Lt(){let e=document.getElementById("security-warning");e&&e.classList.add("hidden")}v();w();var le=!1;function At(e){let t=document.getElementById("password-modal"),n=document.getElementById("password-modal-title"),o=document.getElementById("current-password-group"),s=document.getElementById("password-error");if(!t)return;le=I?.passwordSet??!1,n&&(n.textContent=le?"Change Password":"Set Password"),o&&(o.style.display=le?"block":"none"),s&&(s.classList.add("hidden"),s.textContent="");let i=document.getElementById("password-form");i&&i.reset(),t.classList.remove("hidden");let r=le?"current-password":"new-password",l=document.getElementById(r);l&&l.focus()}function ce(){let e=document.getElementById("password-modal");e&&e.classList.add("hidden")}function Dn(e){e.preventDefault();let t=document.getElementById("current-password"),n=document.getElementById("new-password"),o=document.getElementById("confirm-password"),s=document.getElementById("btn-save-password"),i=n?.value??"",r=o?.value??"";if(!i){Y("New password is required");return}if(i!==r){Y("Passwords do not match");return}if(i.length<4){Y("Password must be at least 4 characters");return}let l={currentPassword:le&&t?t.value:null,newPassword:i};s&&(s.disabled=!0,s.textContent="Saving..."),fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(p=>p.json().then(g=>({ok:p.ok,data:g}))).then(p=>{s&&(s.disabled=!1,s.textContent="Save"),p.ok&&p.data.success?(ce(),ae()):Y(p.data.error||"Failed to change password")}).catch(()=>{s&&(s.disabled=!1,s.textContent="Save"),Y("Connection error")})}function Y(e){let t=document.getElementById("password-error");t&&(t.textContent=e,t.classList.remove("hidden"))}function It(){f("btn-set-password-warning",()=>{At(!0)}),f("btn-dismiss-warning",Lt),f("btn-change-password",()=>{At(!1)}),f("btn-close-password",ce),f("btn-cancel-password",ce);let e=document.querySelector("#password-modal .modal-backdrop");e&&e.addEventListener("click",ce);let t=document.getElementById("password-form");t&&t.addEventListener("submit",Dn)}v();var Fn=30,On=2e3,mo=3e3;function Mt(){let e=document.getElementById("update-panel");if(!e)return;if(!A||!A.available){e.classList.add("hidden");return}e.classList.remove("hidden");let t=e.querySelector(".update-current"),n=e.querySelector(".update-latest"),o=e.querySelector(".update-note"),s=e.querySelector(".update-header");t&&(t.textContent=A.currentVersion),n&&(n.textContent=A.latestVersion),A.sessionsPreserved?(s&&(s.textContent="Quick Update"),o&&(o.textContent="Sessions will stay alive",o.classList.add("update-note-safe"),o.classList.remove("update-note-warning"))):(s&&(s.textContent="Update Available"),o&&(o.textContent="Save your work - sessions will restart",o.classList.add("update-note-warning"),o.classList.remove("update-note-safe")))}function kt(){if(!A||!A.available)return;let t=document.getElementById("update-panel")?.querySelector(".update-btn");t&&(t.disabled=!0,t.textContent="Updating..."),fetch("/api/update/apply",{method:"POST"}).then(n=>{n.ok?(t&&(t.textContent="Restarting..."),po()):(t&&(t.disabled=!1,t.textContent="Update & Restart"),console.error("Update failed"))}).catch(n=>{t&&(t.disabled=!1,t.textContent="Update & Restart"),console.error("Update error:",n)})}function po(){let e=0;function t(){e++,fetch("/api/version",{cache:"no-store"}).then(n=>{n.ok?location.reload():e<Fn&&setTimeout(t,On)}).catch(()=>{e<Fn&&setTimeout(t,On)})}setTimeout(t,mo)}function Wn(){let e=document.getElementById("btn-check-updates"),t=document.getElementById("update-status");e&&(e.disabled=!0,e.textContent="Checking..."),fetch("/api/update/check").then(n=>n.json()).then(n=>{e&&(e.disabled=!1,e.textContent="Check for Updates"),Se(n),Mt();let o=document.getElementById("btn-apply-update");if(t)if(t.classList.remove("hidden"),n&&n.available){t.className="update-status update-status-available";let s="Update available: v"+n.latestVersion;n.sessionsPreserved?s+=" (sessions will stay alive)":s+=" (sessions will restart)",t.textContent=s,o&&o.classList.remove("hidden")}else t.className="update-status update-status-current",t.textContent="You are running the latest version",o&&o.classList.add("hidden")}).catch(n=>{e&&(e.disabled=!1,e.textContent="Check for Updates"),t&&(t.classList.remove("hidden"),t.className="update-status update-status-error",t.textContent="Failed to check for updates"),console.error("Update check error:",n)})}w();var fo="https://api.github.com/repos/AiTlbx/MidTerm/releases?per_page=10",go="https://github.com/AiTlbx/MidTerm/releases";function Un(){let e=document.getElementById("changelog-modal"),t=document.getElementById("changelog-body");e&&e.classList.remove("hidden"),t&&(t.innerHTML='<div class="changelog-loading">Loading changelog...</div>'),fetch(fo).then(n=>n.json()).then(n=>{if(!t)return;if(!n||n.length===0){t.innerHTML="<p>No releases found.</p>";return}let o="";n.forEach(s=>{let i=s.tag_name||"Unknown",r=s.published_at?new Date(s.published_at).toLocaleDateString():"",l=s.body||"No release notes.";o+='<div class="changelog-release">',o+='<div class="changelog-version">'+N(i)+"</div>",r&&(o+='<div class="changelog-date">'+N(r)+"</div>"),o+='<div class="changelog-notes">'+ho(l)+"</div>",o+="</div>"}),t.innerHTML=o}).catch(n=>{t&&(t.innerHTML='<p class="changelog-error">Failed to load changelog. <a href="'+go+'" target="_blank">View on GitHub</a></p>'),console.error("Changelog error:",n)})}function Rt(){let e=document.getElementById("changelog-modal");e&&e.classList.add("hidden")}function ho(e){return N(e).replace(/^### (.+)$/gm,"<h4>$1</h4>").replace(/^## (.+)$/gm,"<h3>$1</h3>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/s,"<ul>$1</ul>").replace(/\n/g,"<br>")}v();L();w();window.mmDebug={get terminals(){return u},get activeId(){return c},get settings(){return m}};Yt();document.addEventListener("DOMContentLoaded",vo);function vo(){Vt(),wn(),Cn();let e=St();be(e),So(),Te(),we(),wt(),Lo(),It(),ut(),et(),tt(),wo(),Co(),re(),ae(),Eo(),yo()}function So(){nn({destroyTerminalForSession:Me,applyTerminalScaling:O,renderSessionList:j,updateEmptyState:Re,selectSession:He,updateMobileTitle:Ne,renderUpdatePanel:Mt}),rn({applyTerminalScaling:O,refreshActiveTerminalBuffer:ke}),ft({sendInput:Ce,showBellNotification:To}),nt({sendInput:Ce,pasteToTerminal:vt}),Qe({sendResize:(e,t)=>{an(e,t.cols,t.rows)}}),vn({onSelect:He,onDelete:zn,onRename:bo,onResize:F,onCloseSidebar:Be})}function yo(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&(q||Te(),P||we(),P&&c&&setTimeout(ke,200))})}function Nt(){let e=a.terminalsArea?.getBoundingClientRect(),t=m?.defaultCols??120,n=m?.defaultRows??30;if(e&&e.width>100&&e.height>100){let i=m?.fontSize??14,r=i*Pt,l=i*Ht,p=e.width-V,g=e.height-V,h=Math.floor(p/r),x=Math.floor(g/l);h>ue&&x>me&&(t=Math.min(h,pe),n=Math.min(x,fe))}let o="pending-"+Date.now(),s={id:o,name:null,shellType:"Loading...",cols:t,rows:n};d.push(s),H.add(o),j(),Be(),fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Cols:t,Rows:n})}).then(i=>i.json()).then(i=>{H.delete(o);let r=d.findIndex(l=>l.id===o);r>=0&&d.splice(r,1),K.add(i.id),He(i.id)}).catch(i=>{H.delete(o);let r=d.findIndex(l=>l.id===o);r>=0&&(d.splice(r,1),j(),Re()),console.error("Error creating session:",i)})}function He(e){_&&Pe(),u.forEach(i=>{i.container.classList.add("hidden")}),ee(e);let t=d.find(i=>i.id===e),n=ht(e,t),o=n.serverCols===0,s=K.has(e);n.container.classList.remove("hidden"),requestAnimationFrame(()=>{n.terminal.focus(),o&&!s&&Promise.resolve().then(()=>(yt(),hn)).then(i=>{i.fetchAndWriteBuffer(e,n.terminal)}),s&&K.delete(e)}),j(),Ne(),a.emptyState?.classList.add("hidden")}function zn(e){Me(e);let t=d.findIndex(n=>n.id===e);t>=0&&d.splice(t,1),c===e&&(ee(null),d.length>0&&He(d[0].id)),j(),Re(),Ne(),fetch("/api/sessions/"+e,{method:"DELETE"}).catch(n=>{console.error("Error deleting session:",n)})}function Vn(e,t){let n=d.find(i=>i.id===e);if(!n)return;let o=(t||"").trim(),s=o===""||o===n.shellType?null:o;fetch("/api/sessions/"+e+"/name",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s})}).then(()=>{n.manuallyNamed=!0}).catch(i=>{console.error("Error renaming session:",i)})}function bo(e){let t=a.sessionList?.querySelector(`[data-session-id="${e}"]`);if(!t)return;let n=t.querySelector(".session-title");if(!n)return;let o=d.find(l=>l.id===e),s=o?o.name||o.shellType:"",i=document.createElement("input");i.type="text",i.className="session-rename-input",i.value=s;function r(){Vn(e,i.value),i.replaceWith(n)}i.addEventListener("blur",r),i.addEventListener("keydown",l=>{l.key==="Enter"?(l.preventDefault(),i.blur()):l.key==="Escape"&&(l.preventDefault(),i.replaceWith(n))}),n.replaceWith(i),i.focus(),i.select()}function xo(e){let t=d.find(s=>s.id===e);if(!t)return;let n=t.name||t.shellType,o=prompt("Rename terminal:",n);o!==null&&Vn(e,o)}function Eo(){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().catch(()=>{})}function To(e){if(!m)return;let t=m.bellStyle||"notification",n=d.find(s=>s.id===e),o=n?W(n):"Terminal";if((t==="notification"||t==="both")&&Notification.permission==="granted"&&document.hidden&&new Notification("Bell: "+o,{body:"Terminal bell triggered",icon:"/favicon.ico"}),t==="visual"||t==="both"){let s=u.get(e);s&&(s.container.classList.add("bell-flash"),setTimeout(()=>{s.container.classList.remove("bell-flash")},200))}}function wo(){fetch("/api/version").then(e=>e.text()).then(e=>{let t=e.split(/[+-]/)[0].split(".").slice(0,3).join("."),n=document.getElementById("app-version");n&&(n.textContent="v"+t)}).catch(()=>{})}function Co(){fetch("/api/networks").then(e=>e.json()).then(e=>{let t=document.getElementById("network-list");t&&(t.innerHTML=e.map(n=>'<div class="network-item"><span class="network-name" title="'+N(n.name)+'">'+N(n.name)+'</span><span class="network-ip">'+N(n.ip)+":"+location.port+"</span></div>").join(""))}).catch(()=>{})}function Lo(){f("btn-new-session",Nt),f("btn-new-session-mobile",Nt),f("btn-create-terminal",Nt),f("btn-hamburger",xn),f("btn-collapse-sidebar",En),f("btn-expand-sidebar",Tn),a.sidebarOverlay&&a.sidebarOverlay.addEventListener("click",Be),f("btn-ctrlc-mobile",()=>{c&&Ce(c,"")}),f("btn-resize-mobile",()=>{c&&F(c)}),f("btn-rename-mobile",()=>{c&&xo(c)}),f("btn-close-mobile",()=>{c&&zn(c)}),a.settingsBtn&&a.settingsBtn.addEventListener("click",Et),f("update-btn",kt),f("btn-check-updates",Wn),f("btn-apply-update",kt),f("btn-show-changelog",Un),f("btn-close-changelog",Rt);let e=document.querySelector("#changelog-modal .modal-backdrop");e&&e.addEventListener("click",Rt),Promise.resolve().then(()=>(Ct(),_n)).then(t=>{t.bindSettingsAutoSave()})}})();
